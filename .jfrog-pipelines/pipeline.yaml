resources:
  - name: avigdor_e2e_git_repo
    type: GitRepo
    configuration:
      path: MotiHarmats/avigdor-e2e
      gitProvider: avigdor_e2e_project_gh_integration
      branches:
        include: master
      buildOn:
        commit: true
        pullRequestCreate: true

pipelines:
  - name: avigdor_e2e_pipeline
    steps:
      - name: npm_install
        type: Bash
        configuration:
          integrations:
            - name: {{.jfrog-pipelines.localArtifactory}}
          inputResources:
            - name: avigdor_e2e_git_repo
        execution:
          onExecute:
            - cd $res_repo_git_resourcePath
            - npm install
      - name: npm_audit
        type: Bash
        configuration:
          inputSteps:
            - name: first_step
        execution:
          onExecute:
            - cd $res_repo_git_resourcePath
            - npm audit
